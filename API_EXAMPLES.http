# Ejemplos de uso de la API - Calculadora con Patrón Memento

## Configuración
BASE_URL=http://localhost:3000/api/calculator

---

## 1. Verificar estado inicial
GET http://localhost:3000/api/calculator/state

### Respuesta esperada:
```json
{
  "success": true,
  "data": {
    "currentValue": 0,
    "lastOperation": "initial",
    "historyInfo": {
      "totalStates": 1,
      "currentIndex": 0,
      "canUndo": false,
      "canRedo": false
    }
  }
}
```

---

## 2. Evaluar expresión simple: 10+10
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "10+10"
}

### Respuesta esperada:
```json
{
  "success": true,
  "data": {
    "result": 20,
    "expression": "10+10",
  "operation": "10+10",
    "canUndo": true,
    "canRedo": false
  }
}
```

---

## 3. Evaluar con múltiples operaciones: 10-20+5
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "10-20+5"
}

### Respuesta esperada:
```json
{
  "success": true,
  "data": {
    "result": -5,
    "expression": "10-20+5",
  "operation": "10-20+5",
    "canUndo": true,
    "canRedo": false
  }
}
```

---

## 4. Evaluar con multiplicación y suma: 12*0.5+20*0.5
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "12*0.5+20*0.5"
}

### Respuesta esperada:
```json
{
  "success": true,
  "data": {
    "result": 16,
    "expression": "12*0.5+20*0.5",
  "operation": "12*0.5+20*0.5",
    "canUndo": true,
    "canRedo": false
  }
}
```

---

## 5. Evaluar con paréntesis: (2+3)*4-5/2
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "(2+3)*4-5/2"
}

### Respuesta esperada:
```json
{
  "success": true,
  "data": {
    "result": 17.5,
    "expression": "(2+3)*4-5/2",
  "operation": "(2+3)*4-5/2",
    "canUndo": true,
    "canRedo": false
  }
}
```

---

## 6. Ver historial completo
GET http://localhost:3000/api/calculator/history

### Respuesta esperada:
```json
{
  "success": true,
  "data": {
    "history": [
      {
        "state": 0,
        "operation": "initial",
        "timestamp": "2025-11-08T...",
        "isCurrent": false
      },
      {
        "state": 20,
        "operation": "10+10",
        "timestamp": "2025-11-08T...",
        "isCurrent": false
      },
      {
        "state": -5,
        "operation": "10-20+5",
        "timestamp": "2025-11-08T...",
        "isCurrent": false
      },
      {
        "state": 16,
        "operation": "12*0.5+20*0.5",
        "timestamp": "2025-11-08T...",
        "isCurrent": false
      },
      {
        "state": 17.5,
        "operation": "(2+3)*4-5/2",
        "timestamp": "2025-11-08T...",
        "isCurrent": true
      }
    ],
    "info": {
      "totalStates": 5,
      "currentIndex": 4,
      "canUndo": true,
      "canRedo": false
    }
  }
}
```

---

## 7. Deshacer (Undo) - Volver al estado anterior
POST http://localhost:3000/api/calculator/undo

### Respuesta esperada:
```json
{
  "success": true,
  "message": "Operación deshecha",
  "data": {
    "currentValue": 16,
    "lastOperation": "12*0.5+20*0.5",
    "canUndo": true,
    "canRedo": true
  }
}
```

---

## 8. Deshacer nuevamente - Volver a -5
POST http://localhost:3000/api/calculator/undo

### Respuesta esperada:
```json
{
  "success": true,
  "message": "Operación deshecha",
  "data": {
    "currentValue": -5,
    "lastOperation": "10-20+5",
    "canUndo": true,
    "canRedo": true
  }
}
```

---

## 9. Rehacer (Redo) - Volver a 16
POST http://localhost:3000/api/calculator/redo

### Respuesta esperada:
```json
{
  "success": true,
  "message": "Operación rehecha",
  "data": {
    "currentValue": 16,
    "lastOperation": "12*0.5+20*0.5",
    "canUndo": true,
    "canRedo": true
  }
}
```

---

## 10. Limpiar calculadora
POST http://localhost:3000/api/calculator/clear

### Respuesta esperada:
```json
{
  "success": true,
  "message": "Calculadora reiniciada",
  "data": {
    "currentValue": 0,
    "lastOperation": "clear"
  }
}
```

---

## Pruebas de errores

### Error: División por cero
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "10/0"
}

### Respuesta esperada:
```json
{
  "success": false,
  "error": {
    "message": "No se puede dividir por cero"
  }
}
```

---

### Error: Operador no soportado
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "10^2"
}

### Respuesta esperada:
```json
{
  "success": false,
  "error": {
    "message": "Símbolo no soportado: '^'"
  }
}
```

---

### Error: Paréntesis desbalanceados
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": "(10+5)*2)"
}

### Respuesta esperada:
```json
{
  "success": false,
  "error": {
    "message": "Paréntesis desbalanceados"
  }
}
```

---

### Error: Expresión vacía
POST http://localhost:3000/api/calculator/evaluate
Content-Type: application/json

{
  "expression": ""
}

### Respuesta esperada:
```json
{
  "success": false,
  "message": "El campo \"expression\" es requerido y debe ser un string"
}
```

---

## Comandos PowerShell (para Windows)

```powershell
# Estado inicial
Invoke-RestMethod -Uri http://localhost:3000/api/calculator/state

# Evaluar 10+10
$body = '{"expression":"10+10"}'
Invoke-RestMethod -Method Post -Uri http://localhost:3000/api/calculator/evaluate -ContentType 'application/json' -Body $body

# Evaluar expresión compleja
$body = '{"expression":"(5+3)*2-4"}'
Invoke-RestMethod -Method Post -Uri http://localhost:3000/api/calculator/evaluate -ContentType 'application/json' -Body $body

# Deshacer
Invoke-RestMethod -Method Post -Uri http://localhost:3000/api/calculator/undo

# Rehacer
Invoke-RestMethod -Method Post -Uri http://localhost:3000/api/calculator/redo

# Ver historial
Invoke-RestMethod -Uri http://localhost:3000/api/calculator/history

# Limpiar
Invoke-RestMethod -Method Post -Uri http://localhost:3000/api/calculator/clear
```

## Comandos cURL (para Linux/Mac)

```bash
# Estado inicial
curl http://localhost:3000/api/calculator/state

# Evaluar 10+10
curl -X POST http://localhost:3000/api/calculator/evaluate -H "Content-Type: application/json" -d '{"expression":"10+10"}'

# Evaluar expresión compleja
curl -X POST http://localhost:3000/api/calculator/evaluate -H "Content-Type: application/json" -d '{"expression":"(5+3)*2-4"}'

# Deshacer
curl -X POST http://localhost:3000/api/calculator/undo

# Rehacer
curl -X POST http://localhost:3000/api/calculator/redo

# Ver historial
curl http://localhost:3000/api/calculator/history

# Limpiar
curl -X POST http://localhost:3000/api/calculator/clear
```
